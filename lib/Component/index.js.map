{"version":3,"sources":["../../src/Component/index.js"],"names":["onBlur","_event","_data","state","Slate","componentDidMount","selection","window","getSelection","updateToolbar","shouldComponentUpdate","nextProps","editorState","props","toolbar","focused","readOnly","componentDidUpdate","onStateChange","onChange","handleOpen","portal","firstChild","isBlurred","isCollapsed","left","top","width","style","opacity","scrollY","offsetHeight","scrollX","offsetWidth","id","schema","plugins","onKeyDown","HoverButtons","ToolbarButtons","focus","isOpened","isExpanded","isFocused","padding","backgroundColor","Boolean","Component"],"mappings":";;;;;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;;;AACA;;;;;;;;+eARA;;;AAUA,IAAMA,SAAS,SAATA,MAAS,CAACC,MAAD,EAASC,KAAT,EAAgBC,KAAhB;AAAA,SAA0BA,KAA1B;AAAA,CAAf;;IAIMC,K;;;;;;;;;;;;;;oLACJC,iB,GAAoB,YAAM;AACxB,YAAKC,SAAL,GAAiBC,OAAOC,YAAP,EAAjB;AACA,YAAKC,aAAL;AACD,K,QAEDC,qB,GAAwB;AAAA,aACtBC,UAAUR,KAAV,CAAgBS,WAAhB,KAAgC,MAAKC,KAAL,CAAWV,KAAX,CAAiBS,WAAjD,IACAD,UAAUR,KAAV,CAAgBW,OAAhB,KAA4B,MAAKD,KAAL,CAAWV,KAAX,CAAiBW,OAD7C,IAEAH,UAAUI,OAAV,KAAsB,MAAKF,KAAL,CAAWE,OAFjC,IAGAJ,UAAUK,QAAV,KAAuB,MAAKH,KAAL,CAAWG,QAJZ;AAAA,K,QAMxBC,kB,GAAqB;AAAA,aAAM,MAAKR,aAAL,EAAN;AAAA,K,QAKrBS,a,GAAgB,uBAAe;AAC7B,YAAKL,KAAL,CAAWM,QAAX,CAAoB,EAAEP,wBAAF,EAApB;AACD,K,QAEDQ,U,GAAa,kBAAU;AACrB,YAAKN,OAAL,GAAeO,OAAOC,UAAtB;AACD,K,QAEDb,a,GAAgB,YAAM;AAAA,UACZG,WADY,GACI,MAAKC,KAAL,CAAWV,KADf,CACZS,WADY;;AAEpB,UAAME,UAAU,MAAKA,OAArB;;AAEA,UAAI,CAACA,OAAD,IAAYF,YAAYW,SAAxB,IAAqCX,YAAYY,WAArD,EAAkE;AAChE;AACD;;AANmB,sBAQS,kCART;AAAA,UAQZC,IARY,aAQZA,IARY;AAAA,UAQNC,GARM,aAQNA,GARM;AAAA,UAQDC,KARC,aAQDA,KARC;;AAUpBb,cAAQc,KAAR,CAAcC,OAAd,GAAwB,CAAxB;AACAf,cAAQc,KAAR,CAAcF,GAAd,GAAuBA,MAAMnB,OAAOuB,OAAb,GAAuBhB,QAAQiB,YAAtD;AACAjB,cAAQc,KAAR,CAAcH,IAAd,GAAwBA,OACtBlB,OAAOyB,OADe,GAEtBlB,QAAQmB,WAAR,GAAsB,CAFA,GAGtBN,QAAQ,CAHV;AAID,K;;;;;6BAEQ;AAAA,mBAYH,KAAKd,KAZF;AAAA,UAELE,OAFK,UAELA,OAFK;AAAA,UAGLC,QAHK,UAGLA,QAHK;AAAA,UAILkB,EAJK,UAILA,EAJK;AAAA,UAKItB,WALJ,UAKLT,KALK,CAKIS,WALJ;AAAA,UAMLuB,MANK,UAMLA,MANK;AAAA,UAOLC,OAPK,UAOLA,OAPK;AAAA,UAQLC,SARK,UAQLA,SARK;AAAA,UASLC,YATK,UASLA,YATK;AAAA,UAULC,cAVK,UAULA,cAVK;AAAA,UAWLC,KAXK,UAWLA,KAXK;;AAaP,UAAMC,WAAW7B,YAAY8B,UAAZ,IAA0B9B,YAAY+B,SAAvD;AACA,aACE;AAAA;AAAA;AACE;AAAC,oCAAD;AAAA,YAAkB,OAAO,+BAAzB;AACE;AAAC,iCAAD;AAAA,cAAQ,UAAUF,QAAlB,EAA4B,QAAQ,KAAKrB,UAAzC;AAEE;AAAA;AAAA;AACE,2BAAU,2DADZ;AAEE,uBAAO,EAAEwB,SAAS,CAAX,EAAcC,iBAAiB,SAA/B;AAFT;AAIE,4CAAC,YAAD;AACE,6BAAajC,WADf;AAEE,0BAAU,KAAKM,aAFjB;AAGE,uBAAOsB;AAHT;AAJF;AAFF;AADF,SADF;AAgBE,sCAAC,aAAD;AACE,oBAAU,KAAKtB,aADjB;AAEE,qBAAWmB,SAFb;AAGE,oBAAUS,QAAQ9B,QAAR,CAHZ;AAIE,kBAAQhB,MAJV;AAKE,kBAAQmC,MALV;AAME,iBAAOvB,WANT;AAOE,mBAASwB;AAPX,UAhBF;AAyBGpB,oBAAY,CAACD,OAAb,GAAuB,IAAvB,GAEG;AAAC,iCAAD;AAAA,YAAe,KAAKmB,EAApB,EAAwB,MAAMnB,OAA9B;AACE,wCAAC,cAAD;AACE,iBAAKmB,EADP;AAEE,gBAAIA,EAFN;AAGE,yBAAatB,WAHf;AAIE,sBAAU,KAAKM,aAJjB;AAKE,mBAAOsB;AALT;AADF;AA3BN,OADF;AAyCD;;;;EAlGiBO,gB;;kBAqGL3C,K","file":"index.js","sourcesContent":["/* eslint-disable no-alert, prefer-reflect, no-underscore-dangle */\nimport createMuiTheme from 'material-ui/styles/createMuiTheme'\nimport MuiThemeProvider from 'material-ui/styles/MuiThemeProvider'\nimport React, { Component } from 'react'\nimport Portal from 'react-portal'\nimport position from 'selection-position'\nimport { Editor } from 'slate'\nimport BottomToolbar from 'ory-editor-ui/lib/BottomToolbar'\nimport { ContentPluginProps } from 'ory-editor-core/lib/service/plugin/classes'\n\nconst onBlur = (_event, _data, state) => state\n\nexport type Props = ContentPluginProps<{ editorState: Object }>\n\nclass Slate extends Component {\n  componentDidMount = () => {\n    this.selection = window.getSelection()\n    this.updateToolbar()\n  }\n\n  shouldComponentUpdate = nextProps =>\n    nextProps.state.editorState !== this.props.state.editorState ||\n    nextProps.state.toolbar !== this.props.state.toolbar ||\n    nextProps.focused !== this.props.focused ||\n    nextProps.readOnly !== this.props.readOnly\n\n  componentDidUpdate = () => this.updateToolbar()\n\n  props: ContentPluginProps<{ editorState: Object }>\n  portal: any\n\n  onStateChange = editorState => {\n    this.props.onChange({ editorState })\n  }\n\n  handleOpen = portal => {\n    this.toolbar = portal.firstChild\n  }\n\n  updateToolbar = () => {\n    const { editorState } = this.props.state\n    const toolbar = this.toolbar\n\n    if (!toolbar || editorState.isBlurred || editorState.isCollapsed) {\n      return\n    }\n\n    const { left, top, width } = position()\n\n    toolbar.style.opacity = 1\n    toolbar.style.top = `${top + window.scrollY - toolbar.offsetHeight}px`\n    toolbar.style.left = `${left +\n      window.scrollX -\n      toolbar.offsetWidth / 2 +\n      width / 2}px`\n  }\n\n  render() {\n    const {\n      focused,\n      readOnly,\n      id,\n      state: { editorState },\n      schema,\n      plugins,\n      onKeyDown,\n      HoverButtons,\n      ToolbarButtons,\n      focus\n    } = this.props\n    const isOpened = editorState.isExpanded && editorState.isFocused\n    return (\n      <div>\n        <MuiThemeProvider theme={createMuiTheme()}>\n          <Portal isOpened={isOpened} onOpen={this.handleOpen}>\n            {/* ory-prevent-blur is required to prevent global blurring */}\n            <div\n              className=\"ory-prevent-blur ory-plugins-content-slate-inline-toolbar\"\n              style={{ padding: 0, backgroundColor: '#212121' }}\n            >\n              <HoverButtons\n                editorState={editorState}\n                onChange={this.onStateChange}\n                focus={focus}\n              />\n            </div>\n          </Portal>          \n        </MuiThemeProvider>\n        <Editor\n          onChange={this.onStateChange}\n          onKeyDown={onKeyDown}\n          readOnly={Boolean(readOnly)}\n          onBlur={onBlur}\n          schema={schema}\n          state={editorState}\n          plugins={plugins}\n        />\n        {readOnly || !focused ? null :\n          (\n            <BottomToolbar key={id} open={focused}>\n              <ToolbarButtons\n                key={id}\n                id={id}\n                editorState={editorState}\n                onChange={this.onStateChange}\n                focus={focus}\n              />\n          </BottomToolbar>\n          )\n        }\n      </div>\n    )\n  }\n}\n\nexport default Slate\n"]}